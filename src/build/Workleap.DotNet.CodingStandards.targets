<Project>
  <!-- Register the EditorConfig files to the project -->
  <!-- Remember that a particular .NET analysis rule can only be configured once across all imported global EditorConfig files -->
  <ItemGroup>
    <!-- Basic EditorConfig settings such as encoding, indentation, etc. -->
    <EditorConfigFiles Include="$(MSBuildThisFileDirectory)\..\files\1_FileDefaults.editorconfig" />

    <!-- C# code style -->
    <EditorConfigFiles Include="$(MSBuildThisFileDirectory)\..\files\2_CodeStyle.editorconfig" />

    <!-- .NET analyzers configuration for all projects, enforcing C# code style, quality, performance and security -->
    <EditorConfigFiles Include="$(MSBuildThisFileDirectory)\..\files\analyzers\*.editorconfig" />

    <!-- Configure ReSharper analyzers that overlaps with built-in .NET analyzers (only appears in Rider and VisualStudio IDEs) -->
    <EditorConfigFiles Include="$(MSBuildThisFileDirectory)\..\files\3_ReSharperAnalyzers.editorconfig" />

    <!-- .NET analyzers configuration only for test projects -->
    <EditorConfigFiles Include="$(MSBuildThisFileDirectory)\..\files\4_TestProjectsAnalyzers.editorconfig" Condition="'$(IsTestProject)' == 'true'" />
  </ItemGroup>

  <!-- Banned Symbols -->
  <PropertyGroup>
    <IncludeDefaultBannedSymbols Condition="$(IncludeDefaultBannedSymbols) == ''">true</IncludeDefaultBannedSymbols>
    <BanNewtonsoftJsonSymbols Condition="$(BanNewtonsoftJsonSymbols) == ''">false</BanNewtonsoftJsonSymbols>
  </PropertyGroup>

  <ItemGroup>
    <AdditionalFiles Include="$(MSBuildThisFileDirectory)\..\files\BannedSymbols.txt"
      Condition="$(IncludeDefaultBannedSymbols) == 'true'"
      Visible="false" />
    <AdditionalFiles Include="$(MSBuildThisFileDirectory)\..\files\BannedSymbols.Newtonsoft.Json.txt"
      Condition="$(BanNewtonsoftJsonSymbols) == 'true'"
      Visible="false" />
  </ItemGroup>

  <!-- When publishing a container with single-RID builds, use the native executable as the entrypoint (dotnet myapp.dll => myapp) -->
  <!-- _ComputeContainerExecutionArgs: https://github.com/dotnet/sdk/blob/d963b10530b152cc453043bb2eaf72a357f6a45c/src/Containers/packaging/build/Microsoft.NET.Build.Containers.targets#L191 -->
  <!-- ComputeContainerConfig: https://github.com/dotnet/sdk/blob/d963b10530b152cc453043bb2eaf72a357f6a45c/src/Containers/packaging/build/Microsoft.NET.Build.Containers.targets#L74 -->
  <Target Name="UpdateContainerCommand"
          AfterTargets="_ComputeContainerExecutionArgs"
          BeforeTargets="ComputeContainerConfig"
          Condition="'$(ContainerUseNativeCommand)' == 'true' AND '$(_IsSingleRIDBuild)' == 'true'">
    <PropertyGroup>
      <_ContainerNativeExecutableExtension Condition="'$(_ContainerIsTargetingWindows)' == 'true'">.exe</_ContainerNativeExecutableExtension>
    </PropertyGroup>
    <ItemGroup>
      <ContainerAppCommand Remove="@(ContainerAppCommand)" />
      <ContainerAppCommand Include="$(ContainerWorkingDirectory)$(AssemblyName)$(_ContainerNativeExecutableExtension)" />
    </ItemGroup>
  </Target>
</Project>
